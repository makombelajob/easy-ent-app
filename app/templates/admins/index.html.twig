{% extends 'base.html.twig' %}
{% block title %}Espace Administrateur
{% endblock %}
{% block body %}

	<div class="container mt-5">
		<h1 class="text-center mb-4">Tableau de bord Administrateur</h1>

		<div
			class="row g-4">
			<!-- === √âTUDIANTS === -->
			<div class="col-12 col-lg-6">
				<div class="card shadow-sm">
					<div class="card-header bg-primary text-white">
						<h5 class="mb-0">√âtudiants</h5>
					</div>
					<div class="card-body table-responsive">
						<table class="table table-striped align-middle">
							<thead>
								<tr>
									<th>ID</th>
									<th>Classe</th>
									<th>Niveau</th>
									<th>Date de naissance</th>
									<th>Adresse</th>
								</tr>
							</thead>
							<tbody>
								{% for student in students %}
									<tr>
										<td>{{ student.id }}</td>
										<td>{{ student.class }}</td>
										<td>{{ student.level }}</td>
										<td>{{ student.dateOfBirth|date('d/m/Y') }}</td>
										<td>{{ student.address }}</td>
									</tr>
								{% else %}
									<tr>
										<td colspan="5" class="text-center text-muted">Aucun √©tudiant trouv√©</td>
									</tr>
								{% endfor %}
							</tbody>
						</table>
					</div>
				</div>
			</div>

			<!-- === ENSEIGNANTS === -->
			<div class="col-12 col-lg-6">
				<div class="card shadow-sm">
					<div class="card-header bg-success text-white">
						<h5 class="mb-0">Enseignants</h5>
					</div>
					<div class="card-body table-responsive">
						<table class="table table-striped align-middle">
							<thead>
								<tr>
									<th>ID</th>
									<th>Num√©ro</th>
									<th>Sp√©cialit√©</th>
									<th>D√©partement</th>
									<th>Date d'embauche</th>
								</tr>
							</thead>
							<tbody>
								{% for teacher in teachers %}
									<tr>
										<td>{{ teacher.id }}</td>
										<td>{{ teacher.teacherNumber }}</td>
										<td>{{ teacher.speciality }}</td>
										<td>{{ teacher.department }}</td>
										<td>{{ teacher.hireDate ? teacher.hireDate|date('d/m/Y') : '-' }}</td>
									</tr>
								{% else %}
									<tr>
										<td colspan="5" class="text-center text-muted">Aucun enseignant trouv√©</td>
									</tr>
								{% endfor %}
							</tbody>
						</table>
					</div>
				</div>
			</div>

			<!-- === PARENTS === -->
			<div class="col-12 col-lg-6">
				<div class="card shadow-sm">
					<div class="card-header bg-warning">
						<h5 class="mb-0">Parents</h5>
					</div>
					<div class="card-body table-responsive">
						<table class="table table-striped align-middle">
							<thead>
								<tr>
									<th>ID</th>
									<th>Profession</th>
									<th>Entreprise</th>
									<th>Enfants</th>
								</tr>
							</thead>
							<tbody>
								{% for parentUser in parents %}
									<tr>
										<td>{{ parentUser.id }}</td>
										<td>{{ parentUser.profession }}</td>
										<td>{{ parentUser.workspace }}</td>
										<td>{{ parentUser.students|length }}</td>
									</tr>
								{% else %}
									<tr>
										<td colspan="4" class="text-center text-muted">Aucun parent trouv√©</td>
									</tr>
								{% endfor %}
							</tbody>
						</table>
					</div>
				</div>
			</div>

			<!-- === PAIEMENTS === -->
			<div class="col-12 col-lg-6">
				<div class="card shadow-sm">
					<div class="card-header bg-danger text-white">
						<h5 class="mb-0">Paiements / Factures</h5>
					</div>
					<div class="card-body table-responsive">
						<table class="table table-striped align-middle">
							<thead>
								<tr>
									<th>ID</th>
									<th>Montant (‚Ç¨)</th>
									<th>Type</th>
									<th>Statut</th>
									<th>√âch√©ance</th>
									<th>Facture</th>
								</tr>
							</thead>
							<tbody>
								{% for payment in payments %}
									<tr>
										<td>{{ payment.id }}</td>
										<td>{{ payment.amount }}</td>
										<td>{{ payment.type }}</td>
										<td>
											{% if payment.status == 'paid' %}
												<span class="badge bg-success">Pay√©</span>
											{% elseif payment.status == 'pending' %}
												<span class="badge bg-warning text-dark">En attente</span>
											{% else %}
												<span class="badge bg-danger">√âchou√©</span>
											{% endif %}
										</td>
										<td>{{ payment.dueDate|date('d/m/Y') }}</td>
										<td>
											<a href="{{ path('admin_invoice', { id: payment.id }) }}" class="btn btn-sm btn-outline-primary">
												üßæ G√©n√©rer
											</a>
										</td>
									</tr>
								{% else %}
									<tr>
										<td colspan="6" class="text-center text-muted">Aucun paiement trouv√©</td>
									</tr>
								{% endfor %}
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
	</div>

{% endblock %}

